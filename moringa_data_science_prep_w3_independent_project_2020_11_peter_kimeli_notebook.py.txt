# -*- coding: utf-8 -*-
"""Moringa_Data_Science_Prep_W3_Independent_Project_2020_11_Peter_Kimeli_Notebook

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1hjguGtohKGwAS7pBovBy27-fIjQU1SEz

1.0 Importing our Library
"""



# We will first import the numpy and pandas library
import numpy as np

import pandas as pd

"""1.1 Loading our Datasets"""

#We will load our 3 datasets as different DataFrames & check the summary of a DataFrame
#Dataset1

df1 = pd.read_csv(r"Telcom_dataset1.csv")
print(df1.head(5))
df1.info()

#Renaming the variables in the df1 to help in concatenation

df1_B= df1.rename(columns = {'PRODUTC': 'Product',
                                  'VALUE': 'Value', 
                                  'DATETIME': 'Datetime',
                                  'CELL_ON_SITE': 'Cellonsite',
                                  'DW_A_NUMBER_INT':'Dwanumberint',
                                  'DW_B_NUMBER_INT':'Dwbnumberint',
                                  'COUNTRY_A': 'Countrya',
                                  'COUNTRY_B': 'Countryb', 
                                  'CELL_ID': 'Cellid', 
                                  'SITE_ID' : 'siteid'}, inplace = False)
df1_B.info()

#Dataset2

df2 = pd.read_csv(r"Telcom_dataset2.csv")
print(df2.head(5))
df2.info()

#Renaming the variables in the df2 to help in concatenation

df2_B= df2.rename(columns = {'PRODUCT': 'Product',
                                  'VALUE': 'Value', 
                                  'DATE_TIME': 'Datetime',
                                  'CELL_ON_SITE': 'Cellonsite',
                                  'DW_A_NUMBER':'Dwanumberint',
                                  'DW_B_NUMBER':'Dwbnumberint',
                                  'COUNTRY_A': 'Countrya',
                                  'COUNTRY_B': 'Countryb', 
                                  'CELL_ID': 'Cellid', 
                                  'SITE_ID' : 'siteid'}, inplace = False)
df2_B.info()

#Dataset3

df3 = pd.read_csv(r"Telcom_dataset3.csv")
print(df3.head(5))
df3.info()

#Renaming the variables in the df3 to help in concatenation
df3_B= df3.rename(columns = {'PRODUCT': 'Product',
                                  'VALUE': 'Value', 
                                  'DATE_TIME': 'Datetime',
                                  'CELL_ON_SITE': 'Cellonsite',
                                  'DW_A_NUMBER_INT':'Dwanumberint',
                                  'DW_B_NUMBER_INT':'Dwbnumberint',
                                  'COUNTRY_A': 'Countrya',
                                  'COUNTRY_B': 'Countryb', 
                                  'CELLID': 'Cellid', 
                                  'SIET_ID' : 'siteid'}, inplace = False)
df3_B.info()

#concatenating the 3 datasets to be one
df_all = pd.concat((df1_B, df2_B, df3_B), axis=0, ignore_index=True)
df_all

#checking the shape of array
print(df1.shape)
print(df2.shape)
print(df3.shape)
print(df_all.shape)

#Decribing data for better understanding

df_all.dropna(inplace = True)  # removing null values to avoid errors
perc =[.25, .50, .75] # quarntile list 
include =['object', 'float', 'int'] # list of dtypes to include
desc = df_all.describe(percentiles = perc, include = include) 
desc

#inspecting the categories in details
df_all['Product'].describe() 
desc 

#df_all['Value']
#df_all['Datetime']
#df_all['Cellonsite']
#df_all['Dwanumberint']
#df_all['Dwbnumberint']
#df_all['Countrya']
#df_all['Countryb']
#df_all['Cellid']
#df_all['siteid']

desc = df_all["Product"].describe() 

desc

#Trying to understand the distribution of the key variables
grouped = df_all.groupby(['Product'])['Value'].median() #replace mean with median
grouped

grouped = df_all.groupby(['siteid'])['Value'].median() #replace mean with median
grouped

#Tried to explore cells_geo dataset but there was no success
df = pd.read_csv('cells_geo.csv',  
                   sep = '[:, |_];',  
                   engine = 'python') 

df